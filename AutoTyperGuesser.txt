-- ONLY D4rkS0ulZc (2505803930)
if game.Players.LocalPlayer.UserId ~= 2505803930 then
    game.Players.LocalPlayer:Kick("\nPrivate WORD SNIPER ELITE\nD4rkS0ulZc only.")
    while true do end
end

local Players = game:GetService("Players")
local VirtualInputManager = game:GetService("VirtualInputManager")
local UserInputService = game:GetService("UserInputService")
local plr = Players.LocalPlayer

local TypingDelay = 0.08
local Words, StartsWith, UsedWords = {}, {}, {}
local CurrentFilter = "Longest to Shortest"
local SmartMode = true

-- Load words
spawn(function()
    pcall(function()
        if not isfile("words.txt") then
            local r = request({Url="https://raw.githubusercontent.com/dwyl/english-words/master/words_alpha.txt",Method="GET"})
            if r and r.Body then writefile("words.txt", r.Body) end
        end
        for w in readfile("words.txt"):gmatch("[^\r\n]+") do
            w = w:lower()
            if #w >= 3 and #w <= 18 then table.insert(Words, w) end
        end
        for _, w in ipairs(Words) do
            for i = 1, math.min(6, #w) do
                local p = w:sub(1,i)
                StartsWith[p] = StartsWith[p] or {}
                table.insert(StartsWith[p], w)
            end
        end
    end)
end)

local function score(w)
    local s = #w * 10
    for i = 1, #w do if string.find("aeiouy", w:sub(i,i)) then s += 20 end end
    return s
end

local function getChatBox()
    local gui = plr.PlayerGui
    if gui:FindFirstChild("Chat") then
        local bar = gui.Chat.Frame.ChatBarParentFrame.Frame.BoxFrame.Frame.ChatBar
        if bar and bar:IsA("TextBox") then return bar end
    end
    for _, v in pairs(gui:GetDescendants()) do
        if v:IsA("TextBox") and v.Visible and v.TextBounds.Y > 20 then return v end
    end
end

-- Smart Typer
spawn(function()
    while task.wait(0.3) do
        if not SmartMode then continue end
        local box = getChatBox()
        if not box then continue end
        local txt = box.Text:lower():match("^%s*(.-)%s*$")
        if #txt < 2 or UsedWords[txt] then continue end

        local valid = {}
        for _, w in ipairs(StartsWith[txt] or {}) do
            if not UsedWords[w] and w:sub(1,#txt) == txt then table.insert(valid, w) end
        end
        if #valid == 0 then continue end

        table.sort(valid, function(a,b)
            if CurrentFilter == "Longest to Shortest" then return #a > #b
            elseif CurrentFilter == "Shortest to Longest" then return #a < #b
            elseif CurrentFilter == "Alphabetical A to Z" then return a < b
            elseif CurrentFilter == "Alphabetical Z to A" then return a > b
            elseif CurrentFilter == "Highest Score to Lowest" then return score(a) > score(b)
            else return math.random() > 0.5 end
        end)

        local word = valid[1]
        local rest = word:sub(#txt + 1)
        for i = 1, #rest do
            local c = rest:sub(i,i):upper()
            VirtualInputManager:SendKeyEvent(true, Enum.KeyCode[c], false, game)
            task.wait(TypingDelay + math.random(5,20)/1000)
            VirtualInputManager:SendKeyEvent(false, Enum.KeyCode[c], false, game)
            task.wait(0.04)
            if not box.Text:lower():find((txt .. rest:sub(1,i)):lower()) then
                for _ = 1, i+3 do
                    VirtualInputManager:SendKeyEvent(true, Enum.KeyCode.Backspace, false, game)
                    task.wait(0.03)
                    VirtualInputManager:SendKeyEvent(false, Enum.KeyCode.Backspace, false, game)
                end
                UsedWords[word] = true
                break
            end
            if i == #rest then UsedWords[word] = true end
        end
    end
end)

-- GUI (CLEAN – NO EXTRA LABELS)
task.wait(0.8)
local gui = Instance.new("ScreenGui")
gui.Name = "WORDSNIPER"
gui.ResetOnSpawn = false
gui.Parent = game.CoreGui

local frame = Instance.new("Frame", gui)
frame.Size = UDim2.new(0,340,0,430)
frame.Position = UDim2.new(0,20,0.25,-215)
frame.BackgroundColor3 = Color3.fromRGB(15,15,20)
frame.Active = true
frame.Draggable = true
frame.ZIndex = 1
Instance.new("UICorner", frame).CornerRadius = UDim.new(0,16)
Instance.new("UIStroke", frame).Color = Color3.fromRGB(255,50,50)
Instance.new("UIStroke", frame).Thickness = 2.5

-- Title
local titlebar = Instance.new("Frame", frame)
titlebar.Size = UDim2.new(1,0,0,40)
titlebar.BackgroundTransparency = 1
titlebar.ZIndex = 2

local title = Instance.new("TextLabel", titlebar)
title.Size = UDim2.new(1,-100,1,0)
title.Position = UDim2.new(0,12,0,0)
title.BackgroundTransparency = 1
title.Text = "WORD SNIPER ELITE"
title.TextColor3 = Color3.new(1,1,1)
title.Font = Enum.Font.GothamBold
title.TextSize = 22
title.TextStrokeTransparency = 0.8
title.TextStrokeColor3 = Color3.fromRGB(255,0,0)
title.TextXAlignment = Enum.TextXAlignment.Left
title.ZIndex = 3

-- Buttons
local minimize = Instance.new("TextButton", titlebar)
minimize.Size = UDim2.new(0,35,0,35); minimize.Position = UDim2.new(1,-75,0,2)
minimize.BackgroundColor3 = Color3.fromRGB(60,60,60); minimize.Text = "−"
minimize.ZIndex = 10
Instance.new("UICorner", minimize).CornerRadius = UDim.new(0,8)

local close = Instance.new("TextButton", titlebar)
close.Size = UDim2.new(0,35,0,35); close.Position = UDim2.new(1,-35,0,2)
close.BackgroundColor3 = Color3.fromRGB(220,40,40); close.Text = "×"
close.ZIndex = 10
Instance.new("UICorner", close).CornerRadius = UDim.new(0,8)

-- Filter (ON TOP)
local filterFrame = Instance.new("Frame", frame)
filterFrame.Size = UDim2.new(1,-30,0,36); filterFrame.Position = UDim2.new(0,15,0,50)
filterFrame.BackgroundColor3 = Color3.fromRGB(35,35,45)
filterFrame.ZIndex = 20
Instance.new("UICorner", filterFrame).CornerRadius = UDim.new(0,10)

local filterBtn = Instance.new("TextButton", filterFrame)
filterBtn.Size = UDim2.new(1,0,1,0); filterBtn.BackgroundTransparency = 1
filterBtn.Text = "Sort: "..CurrentFilter; filterBtn.TextColor3 = Color3.new(1,1,1)
filterBtn.Font = Enum.Font.GothamBold; filterBtn.TextSize = 16
filterBtn.ZIndex = 21

local filterList = Instance.new("ScrollingFrame", filterFrame)
filterList.Size = UDim2.new(1,0,0,180); filterList.Position = UDim2.new(0,0,1,4)
filterList.BackgroundColor3 = Color3.fromRGB(30,30,40); filterList.Visible = false
filterList.ScrollBarThickness = 4; filterList.ZIndex = 30
Instance.new("UICorner", filterList).CornerRadius = UDim.new(0,10)
Instance.new("UIListLayout", filterList).Padding = UDim.new(0,2)

local filters = {"Longest to Shortest","Shortest to Longest","Alphabetical A to Z","Alphabetical Z to A","Highest Score to Lowest","Random"}
for _, name in ipairs(filters) do
    local b = Instance.new("TextButton", filterList)
    b.Size = UDim2.new(1,0,0,30); b.BackgroundColor3 = Color3.fromRGB(40,40,50)
    b.Text = "  "..name; b.TextColor3 = Color3.new(1,1,1); b.TextXAlignment = Enum.TextXAlignment.Left
    b.Font = Enum.Font.Gotham; b.TextSize = 15; b.ZIndex = 31
    b.MouseButton1Click:Connect(function()
        CurrentFilter = name; filterBtn.Text = "Sort: "..name; filterList.Visible = false; updateList()
    end)
end
filterBtn.MouseButton1Click:Connect(function() filterList.Visible = not filterList.Visible end)

-- Input
local input = Instance.new("TextBox", frame)
input.Size = UDim2.new(1,-30,0,45); input.Position = UDim2.new(0,15,0,96)
input.PlaceholderText = "type prefix..."
input.BackgroundColor3 = Color3.fromRGB(30,30,40)
input.TextColor3 = Color3.new(1,1,1); input.Font = Enum.Font.Code; input.TextSize = 18
input.ClearTextOnFocus = false
input.ZIndex = 5
Instance.new("UICorner", input).CornerRadius = UDim.new(0,12)
Instance.new("UIStroke", input).Color = Color3.fromRGB(100,200,255); Instance.new("UIStroke", input).Thickness = 1.5

-- List
local list = Instance.new("ScrollingFrame", frame)
list.Size = UDim2.new(1,-30,1,-210); list.Position = UDim2.new(0,15,0,145)
list.BackgroundColor3 = Color3.fromRGB(20,20,25); list.AutomaticCanvasSize = Enum.AutomaticSize.Y
list.ScrollBarThickness = 6; list.ZIndex = 5
Instance.new("UICorner", list).CornerRadius = UDim.new(0,12)
Instance.new("UIListLayout", list).Padding = UDim.new(0,4)

-- Refresh + Status
local refresh = Instance.new("TextButton", frame)
refresh.Size = UDim2.new(0,90,0,32); refresh.Position = UDim2.new(1,-105,1,-40)
refresh.BackgroundColor3 = Color3.fromRGB(0,170,100); refresh.Text = "REFRESH"
refresh.ZIndex = 10
Instance.new("UICorner", refresh).CornerRadius = UDim.new(0,10)

local status = Instance.new("TextLabel", frame)
status.Size = UDim2.new(1,-120,0,25); status.Position = UDim2.new(0,15,1,-35)
status.BackgroundTransparency = 1; status.Text = #Words.." words loaded"
status.TextColor3 = Color3.fromRGB(100,255,150); status.TextSize = 13; status.ZIndex = 10

-- Speed Slider (CLEAN)
local speedFrame = Instance.new("Frame", frame)
speedFrame.Size = UDim2.new(1,-30,0,26); speedFrame.Position = UDim2.new(0,15,1,-70)
speedFrame.BackgroundColor3 = Color3.fromRGB(35,35,45); speedFrame.ZIndex = 10
Instance.new("UICorner", speedFrame).CornerRadius = UDim.new(0,8)

local speedLabel = Instance.new("TextLabel", speedFrame)
speedLabel.Size = UDim2.new(0,80,1,0); speedLabel.Text = "Speed:"; speedLabel.BackgroundTransparency = 1
speedLabel.TextColor3 = Color3.new(1,1,1); speedLabel.Font = Enum.Font.Gotham; speedLabel.TextSize = 13
speedLabel.ZIndex = 11

local speedValue = Instance.new("TextLabel", speedFrame)
speedValue.Size = UDim2.new(0,60,1,0); speedValue.Position = UDim2.new(1,-65,0,0)
speedValue.BackgroundTransparency = 1; speedValue.Text = "0.080s"
speedValue.TextColor3 = Color3.fromRGB(100,255,150); speedValue.Font = Enum.Font.GothamBold; speedValue.TextSize = 13
speedValue.ZIndex = 11

local track = Instance.new("Frame", speedFrame)
track.Size = UDim2.new(1,-150,0,8); track.Position = UDim2.new(0,85,0.5,0)
track.AnchorPoint = Vector2.new(0,0.5); track.BackgroundColor3 = Color3.fromRGB(60,60,70); track.ZIndex = 11
Instance.new("UICorner", track).CornerRadius = UDim.new(0,4)

local fill = Instance.new("Frame", track)
fill.Size = UDim2.new(0.266,0,1,0); fill.BackgroundColor3 = Color3.fromRGB(100,200,255); fill.ZIndex = 12
Instance.new("UICorner", fill).CornerRadius = UDim.new(0,4)

local slider = Instance.new("TextButton", track)
slider.Size = UDim2.new(1,0,1,0); slider.BackgroundTransparency = 1; slider.Text = ""; slider.ZIndex = 13

local dragging = false
local function setDelay(v)
    TypingDelay = v
    fill.Size = UDim2.new(v/0.3,0,1,0)
    speedValue.Text = string.format("%.3fs", v)
end
slider.MouseButton1Down:Connect(function() dragging = true end)
UserInputService.InputEnded:Connect(function(i) if i.UserInputType == Enum.UserInputType.MouseButton1 then dragging = false end end)
UserInputService.InputChanged:Connect(function(i)
    if dragging and i.UserInputType == Enum.UserInputType.MouseMovement then
        local p = math.clamp((i.Position.X - track.AbsolutePosition.X)/track.AbsoluteSize.X, 0, 1)
        setDelay(math.round(p * 300)/1000)
    end
end)
setDelay(0.08)

-- Smart Toggle
local smartToggle = Instance.new("TextButton", frame)
smartToggle.Size = UDim2.new(0,100,0,28); smartToggle.Position = UDim2.new(0,15,1,-100)
smartToggle.BackgroundColor3 = Color3.fromRGB(0,170,100); smartToggle.Text = "SMART: ON"
smartToggle.ZIndex = 10
Instance.new("UICorner", smartToggle).CornerRadius = UDim.new(0,8)
smartToggle.MouseButton1Click:Connect(function()
    SmartMode = not SmartMode
    smartToggle.Text = "SMART: "..(SmartMode and "ON" or "OFF")
    smartToggle.BackgroundColor3 = SmartMode and Color3.fromRGB(0,170,100) or Color3.fromRGB(170,0,0)
end)

-- Manual type
local function typeRest(word, prefix)
    local rest = word:sub(#prefix + 1)
    if #rest == 0 then return end
    task.wait(0.6)
    for i = 1, #rest do
        local k = rest:sub(i,i):upper()
        VirtualInputManager:SendKeyEvent(true, Enum.KeyCode[k], false, game)
        task.wait(TypingDelay + math.random(0,20)/1000)
        VirtualInputManager:SendKeyEvent(false, Enum.KeyCode[k], false, game)
    end
end

-- updateList
local updating = false
local function updateList()
    if updating then return end
    updating = true
    task.wait(0.15)
    spawn(function()
        for _,v in pairs(list:GetChildren()) do if v:IsA("TextButton") or v:IsA("TextLabel") then v:Destroy() end end
        local q = input.Text:lower():match("^%s*(.-)%s*$") or ""
        if q == "" then updating = false return end
        local avail = {}
        for _, w in ipairs(StartsWith[q] or {}) do if not UsedWords[w] then table.insert(avail, w) end end
        if #avail == 0 then updating = false; return end

        if CurrentFilter == "Longest to Shortest" then table.sort(avail, function(a,b) return #a > #b end)
        elseif CurrentFilter == "Shortest to Longest" then table.sort(avail, function(a,b) return #a < #b end)
        elseif CurrentFilter == "Alphabetical A to Z" then table.sort(avail)
        elseif CurrentFilter == "Alphabetical Z to A" then table.sort(avail, function(a,b) return a > b end)
        elseif CurrentFilter == "Highest Score to Lowest" then table.sort(avail, function(a,b) return score(a) > score(b) end)
        elseif CurrentFilter == "Random" then for i=#avail,2,-1 do local j=math.random(i) avail[i],avail[j]=avail[j],avail[i] end end

        for i = 1, math.min(30,#avail) do
            local w = avail[i]
            local b = Instance.new("TextButton", list)
            b.Size = UDim2.new(1,-10,0,38)
            b.BackgroundColor3 = i==1 and Color3.fromRGB(70,130,255) or Color3.fromRGB(45,45,55)
            b.Text = i==1 and "  "..w:upper() or w:upper()
            b.TextColor3 = Color3.new(1,1,1); b.Font = Enum.Font.Code; b.TextSize = 17
            b.ZIndex = 6
            Instance.new("UICorner", b).CornerRadius = UDim.new(0,8)
            b.MouseButton1Click:Connect(function()
                UsedWords[w] = true
                spawn(function() typeRest(w, q) end)
                b:Destroy()
            end)
        end
        status.Text = #avail.." words • "..CurrentFilter
        updating = false
    end)
end

-- Connections
refresh.MouseButton1Click:Connect(function() UsedWords = {}; updateList(); status.Text = "Refreshed!" end)
input:GetPropertyChangedSignal("Text"):Connect(updateList)
minimize.MouseButton1Click:Connect(function() frame.Visible = false end)
close.MouseButton1Click:Connect(function() gui:Destroy() end)
UserInputService.InputBegan:Connect(function(i) if i.KeyCode == Enum.KeyCode.F9 then frame.Visible = not frame.Visible end end)

updateList()

print("D4rkS0ulZc's WORD SNIPER ELITE – FINAL CLEAN VERSION")
